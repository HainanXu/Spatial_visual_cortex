---
title: "Combining_H07_June20"
author: "Hainan Xu"
date: "20/06/2022"
output: html_document
---

```{r setup, include=FALSE,warning=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The files 42 image samples of "H07-0500_79205589_179_MBP" and 36 ROI(return of information) tables. 6 tables is missing(13,22,25,27,29,30). Here we convert the local coordinate to a global coordinate.
```{R}
library(dplyr)
library(readr)

#first row
df1<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._01_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x)

#x axis + 500
df2<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._02_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500)
#x axis + 1000
df3<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._03_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000)

#second row
df4<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._04_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300)
#x axis + 500
df5<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._05_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300)
#x axis + 1000
df6<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._06_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300)

#third row
df7<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._07_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+600)
#x axis + 500
df8<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._08_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+600)
#x axis + 1000
df9<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._09_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+600)

#fourth row
df10<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._10_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+900)
#x axis + 500
df11<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._11_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+900)
#x axis + 1000
df12<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._12_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+900)


#fifth row
#df13<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._13_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*4)
#x axis + 500
df14<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._14_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*4)
#x axis + 1000
df15<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._15_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*4)

#sixth row
df16<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._16_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*5)
dim(df1)
#x axis + 500
df17<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._17_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*5)
#x axis + 1000
df18<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._18_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*5)

#seventh row
df19<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._19_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*6)
dim(df1)
#x axis + 500
df20<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._20_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*6)
#x axis + 1000
df21<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._21_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*6)

#eighth row
#df22<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._22_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*7)
#x axis + 500
df23<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._23_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*7)
#x axis + 1000
df24<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._24_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*7)

#nineth row
#df25<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._25_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*8)
#x axis + 500
df26<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._26_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*8)
#x axis + 1000
#df27<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._27_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*8)

#tenth row
df28<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._28_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*9)
#x axis + 500
#df29<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._29_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*9)
#x axis + 1000
#df30<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._30_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*9)

#row 11
df31<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._31_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*10)
#x axis + 500
df32<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._32_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*10)
#x axis + 1000
df33<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._33_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*10)

#row 12
df34<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._34_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*11)
#x axis + 500
df35<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._35_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*11)
#x axis + 1000
df36<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._36_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*11)

#row 13
df37<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._37_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*12)
#x axis + 500
df38<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._38_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*12)
#x axis + 1000
df39<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._39_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*12)

#row 14
df40<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._40_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x,com_y=com_y+300*13)
#x axis + 500
df41<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._41_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+500,com_y=com_y+300*13)
#x axis + 1000
df42<-read_csv("data/H07-0500_79205589_179_MBP/H07-0500_79205589_179_MBP._42_analysis_results.csv")%>%select("com_x","com_y","pixel_area")%>%mutate(com_x=com_x+1000,com_y=com_y+300*13)

```

```{R}
#missing 13,22,25,27,29,30
df_full=rbind(df1,df2,df3,
              df4,df5,df6,
              df7,df8,df9,
              df10,df11,df12
                  ,df14,df15,
              df16,df17,df18,
              df19,df20,df21
                  ,df23,df24
                  ,df26     ,
              df28          ,
              df31,df32,df33,
              df34,df35,df36,
              df37,df38,df39,
              df40,df41,df42
              )

library("spatstat")
ln = with(df_full,
  ppp(x = com_x, y = com_y, marks = pixel_area, xrange = range(com_x), yrange = range(com_y)))
d = density(subset(ln), edge=TRUE, diggle=TRUE)
plot(d)

plot(ln)
```
